---
modules: 
  - .al_income
---
# Returns a list of lists, each of which contains the number of
# times a pay period fits into a year and then the English word
# for that period. Example: [12, "Monthly"]
variable name: times_per_year_list
data:
  - [52, "Weekly"]
  - [26, "Once every two weeks"]
  - [24, "Twice per month"]
  - [12, "Monthly"]
  - [4, "Once every 3 months"]
  - [1, "Yearly"]
---
objects:
  # a list of asset sources for a multiple choice dropdown
  - asset_source_list: DAOrderedDict.using(elements=asset_list_dict, auto_gather = False, gathered = True)
---
variable name: asset_list_dict
data: !!omap
  - checking: "Checking Account"
  - savings: "Savings Account"
  - cd: "Certificate of Deposit"
  - ira: "Individual Retirement Account"
  - mutual fund: "Money or Mutual Fund"
  - stocks: "Stocks or Bonds"
  - trust: "Trust Fund"
  - vehicle: "Vehicle"
  - real estate: "Real Estate"
  - other: "Other Asset"
---
objects:
  # dict of income sources for a multiple choice dropdown
  - income_source_list: DAOrderedDict.using(elements=income_list_dict, auto_gather = False, gathered = True)
---
variable name: income_list_dict
data: !!omap
  - wages: "A job or self-employment"
---
code: |
  income_source_list.elements.update(non_wage_income_list)
  update_income_list = True
---
mandatory: True
code: |
  update_income_list
---
objects:
  # a dict of income sources, excluding wages
  - non_wage_income_list: DAOrderedDict.using(elements=non_wage_income_list_dict, auto_gather = False, gathered = True)
---
variable name: non_wage_income_list_dict
data: !!omap
  - SSR: "Social Security Retirement Benefits"
  - SSDI: "Social Security Disability Benefits"
  - SSI: "Supplemental Security Income (SSI)"
  - pension: "Pension"
  - TAFDC: "TAFDC"
  - public assistance: "Other public assistance"
  - SNAP: "Food Stamps (SNAP)"
  - rent: "Income from real estate (rent, etc)"
  - room and board: "Room and/or Board Payments"
  - child support: "Child Support"
  - alimony: "Alimony"
  - other support: "Other Support"
  - other: "Other"
---
objects:
  # a dict of expense sources for a multiple choice dropdown
  - expense_source_list: DAOrderedDict.using(elements=expense_list_dict, auto_gather = False, gathered = True)
---
variable name: expense_list_dict
data: !!omap
  - rent: "Rent"
  - mortgage: "Mortgage"
  - food: "Food"
  - utilities: "Utilities"
  - fuel: "Other Heating/Cooking Fuel"
  - clothing: "Clothing"
  - credit cards: "Credit Card Payments"
  - property tax: "Property Tax (State and Local)"
  - other taxes: "Other taxes and fees related to your home"
  - insurance: "Insurance"
  - medical: "Medical-Dental (after amount paid by insurance)"
  - auto: "Car operation and maintenance"
  - transportation: "Other transportation"
  - charity: "Church or charitable donations"
  - loan payments: "Loan, credit, or lay-away payments"
  - support: "Support to someone not in household"
  - other: "Other"
---
########## Questions
---
generic object: ALItemizedValueDict
continue button field: x.revisit
question: |
  Edit values
subquestion: |
  ${ x.table }

  ${ x.add_action() }
---
generic object: ALItemizedValueDict
table: x.table
rows: x
columns:
  - Type: |
      row_index
  - Amount: |
      '$0' if hasattr(row_item, 'exists') and not row_item.exists else currency(row_item.value)
edit:
  - exists
---
generic object: ALItemizedJob
code: |
  x.source
  x.employer.name.first
  x.times_per_year
  x.to_add.complete_attribute = 'complete'
  x.to_subtract.complete_attribute = 'complete'
  if x.is_part_time:
    x.to_add["part time"].is_hourly = x.is_hourly
  else:
    x.to_add["full time"].is_hourly = x.is_hourly
  x.to_add.gather()
  x.to_subtract.gather()
  x.complete = True
---
generic object: ALItemizedJob
code: |
  x.to_add[i].value
  x.to_add[i].complete = True
---
generic object: ALItemizedJob
code: |
  x.to_subtract[i].value
  x.to_subtract[i].complete = True
---
id: itemized job name
generic object: ALItemizedJob
question: |
  What is your job title?
fields:
  - Job name: x.source
---
sets:
  - x.employer.name.first
id: employer
generic object: ALItemizedJob
question: |
  Tell us who employs you as a ${ x.source }
fields:
  - Name: x.employer.name.first
  - Street: x.employer.address.address
    required: False
  - Unit: x.employer.address.unit
    required: False
  - City: x.employer.address.city
    required: False
  - State: x.employer.address.state
    required: False
  - Zip: x.employer.address.zip
    required: False
  - Phone number: x.employer.phone_number
    required: False
---
id: itemized job line items
generic object: ALItemizedJob
question: |
    Enter info from your paystub for your job as a ${ x.source }
fields:
    - label: |
        % if x.is_hourly:
        What is your hourly pay for this job?
        % else:
        What are your wages for this job?
        % endif
      field: x.to_add['full time'].value
      datatype: currency
      show if:
        code: x.is_part_time is False
    - label: |
        % if x.is_hourly
        What is your hourly pay for this job?
        % else:
        What are your wages for this job?
        % endif
      field: x.to_add['part time'].value
      datatype: currency
      show if:
        code: x.is_part_time is True
    - What are your tips for this job?: x.to_add['tips'].value
      datatype: currency
      required: False
    - What is your federal tax amount?: x.to_subtract['federal_taxes'].value
      datatype: currency
      required: False
    - What do you pay for insurance?: x.to_subtract['insurance'].value
      datatype: currency
      required: False
    - Does the job have other incomes?: x.to_add.there_is_another
      datatype: yesnoradio
    - Does the job have other deductions?: x.to_subtract.there_is_another
      datatype: yesnoradio
---
id: itemized job period
generic object: ALItemizedJob
question: |
  Tell us about your hours when working as a ${ x.source }
fields:
  - Is this a part time job: x.is_part_time
    datatype: yesnoradio
  - Hourly or salary?: x.is_hourly
    input type: radio
    choices:
      - Hourly: True
      - Salary: False
  - How often do you get paid?: x.times_per_year
    input type: radio
    code: |
      times_per_year_list
    datatype: integer
  - How many hours do you work during that time?: x.hours_per_period
    input type: number
    show if: x.is_hourly
---
#id: other itemized job income name
generic object: ALItemizedJob
question: |
  Other incomes
subquestion: |
  You have already told us about your income from **${comma_and_list( [job_items_names.get(key, key).lower() for key in x.to_add.complete_elements().keys()] )}**.
fields:
  - Income name: x.to_add.new_item_name
validation code: |
  if x.to_add.new_item_name in x.to_add.complete_elements().keys():
    validation_error(f'You already told us about your <strong>{ job_items_names.get(x.to_add.new_item_name, x.to_add.new_item_name) }</strong> that pay { currency( x.to_add[ x.to_add.new_item_name ].value )}. Pick a different name.')
---
id: other itemized job income value
generic object: ALItemizedJob
question: |
  What do you get paid for ${ job_items_names.get(i, i) } in your job as a ${ x.source }?
fields:
  - Amount: x.to_add[i].value
    datatype: currency
  - Do you have another source of income?: x.to_add.there_is_another
    datatype: yesnoradio
---
id: other itemized job reduction name
generic object: ALItemizedJob
question: |
  Other deductions
subquestion: |
  You've already told us about what gets taken out for **${comma_and_list( [job_items_names.get(key, key).lower() for key in x.to_subtract.complete_elements().keys()] )}**.
fields:
  - Deduction name: x.to_subtract.new_item_name
validation code: |
  if x.to_subtract.new_item_name in x.to_subtract.complete_elements().keys():
    validation_error(f'You already told us about your <strong>{ job_items_names.get(x.to_subtract.new_item_name, x.to_subtract.new_item_name) }</strong> that take out { currency( x.to_subtract[ x.to_subtract.new_item_name ].value )}. Pick a different name.')
---
id: other itemized job reduction value
generic object: ALItemizedJob
question: |
  What amount is taken out of your paycheck for ${ job_items_names.get(i, i) } in your job as a ${ x.source }?
fields:
  - Amount: x.to_subtract[i].value
    datatype: currency
  - Is there other money being taken out?: x.to_subtract.there_is_another
    datatype: yesnoradio
---
generic object: ALItemizedJob
question: |
  Do you have any other deductions from your paycheck from being a ${ x.source }?
fields:
  - no label: x.to_subtract.there_is_another
    datatype: yesnoradio
---
# UNIQUE ITEMS FOR ALItemizedJobList
---
id: how many itemized jobs
generic object: ALItemizedJobList
question: |
  How many jobs do you have?
fields:
  - no label: x.target_number
    datatype: integer
---
id: name of one itemized job in list
generic object: ALItemizedJobList
question: |
  What is your job title for your ${ordinal(i)} job?
subquestion: |
  % if len(x.complete_elements()) > 0:
  You've already told us about being a ${ comma_and_list([job.source for job in x.complete_elements()]) }.
  % endif
fields:
  - Job title: x[i].source
---
generic object: ALItemizedJobList
continue button field: x.revisit
question: |
  Edit jobs
subquestion: |
  ${ x.table }

  ${ x.add_action() }
---
generic object: ALItemizedJobList
table: x.table
rows: x
columns:
  - Title: |
      row_item.source
  - Employer: |
      row_item.employer.name if hasattr(row_item.employer.name, "first") else ""
  - Annual Gross Income: |
      row_item.gross_total()
  - Annual Deductions: |
      row_item.deduction_total()
edit:
  - source
  - employer.name.first
  - to_add.revisit
  - to_subtract.revisit
confirm: True
---
generic object: ALItemizedJobList
continue button field: x.to_subtract.revisit
question: |
  Edit deductions from ${ x.source }
subquestion: |
  ${ x.to_subtract.table }

  ${ x.add_action() }
---
generic object: ALItemizedJobList
continue button field: x.to_add.revisit
question: |
  Edit incomes from ${ x.source }
subquestion: |
  ${ x.table }

  ${ x.add_action() }
---
# SHARED CODE FOR ALIncome and ALIncomeList and single ALAsset
---
generic object: ALIncome
code: |
  x.source  # assigned where object is added to list
  x.value
  x.complete = True
---
id: income info
generic object: ALIncome
question: |
  How much do you get from ${ x.source }?
fields:
  - Is it an hourly amount?: x.is_hourly
    datatype: yesnoradio
  - Period: x.times_per_year
    input type: radio
    code: |
      times_per_year_list
    datatype: integer
  - How many hours do you work per period?: x.hours_per_period
    datatype: number
    show if: x.is_hourly
  - Amount: x.value
    datatype: currency
  - Who owns this?: x.owner
    required: False
---
# UNIQUE CODE FOR ALIncomeList
---
code: |
  if income_sources.any_true():
    for source in income_sources.true_values():
      one_income = al_income_list.appendObject(source=source)
      # Never put anything else in here
  al_income_list.gathered = True
---
code: |
  for income in al_income_list.elements:
    income.complete
  get_alincome_list_item_values = True
---
# Why is this not being triggered
id: which incomes
question: |
  What are your sources of income?
fields:
  - no label: income_sources
    datatype: checkboxes
    code: |
      income_source_list
---
# SHARED BY ALJob AND ALJobList
---
generic object: ALJob
code: |
  x.source
  x.employer
  x.value
  x.complete = True
---
id: regular job name
generic object: ALJob
question: |
  What is your job title?
fields:
  - Name: x.source
---
id: regular job employer
generic object: ALJob
question: |
  Tell us about who employs you as a ${ x.source }
fields:
  - Name: x.employer
  - Address: x.employer_address
  - Phone: x.employer_phone
---
id: regular job value
generic object: ALJob
question: |
  What how much do you get paid for ${ x.source }?
fields:
  - Is the job hourly?: x.is_hourly
    datatype: yesnoradio
  - How often do you get paid?: x.times_per_year
    input type: radio
    code: |
      times_per_year_list
    datatype: integer
  - How many hours do you work in each period?: x.hours_per_period
    datatype: number
    show if: x.is_hourly
  - What do you get paid?: x.value
    datatype: currency
    show if: x.is_hourly
  - Amount you get paid: x.value
    datatype: currency
    show if:
      variable: x.is_hourly
      is: False
  - What is the net income of the job?: x.net
    datatype: currency
---
# UNIQUE ITEMS FOR ALJobList
---
id: how many regular jobs
generic object: ALJobList
question: |
  How many jobs do you have?
fields:
  - no label: x.target_number
    datatype: integer
---
id: name of one regular job in list
generic object: ALJobList
question: |
  What is your job title?
subquestion: |
  % if len(x.complete_elements()) > 0:
  You've already told us about ${ comma_and_list([job.source for job in x.complete_elements()]) }.
  % endif
fields:
  - Job name: x[i].source
---
# SHARED BY ALAsset AND ALAssetList
---
id: asset info
generic object: ALAsset
question: |
  Tell us about this asset
fields:
  - What type of asset is it?: x.source
    code: |
      asset_source_list
    exclude: |
      ['vehicle']
  - How often do you get this income?: x.times_per_year
    input type: radio
    code: |
      times_per_year_list
    datatype: integer
  - Interest or other income from the asset: x.value
    datatype: currency
  - Who owns this?: x.owner
    required: False
---
# UNIQUE FOR ALAssetList
---
generic object: ALAssetList
code: |
  x[i].source
  x[i].market_value
  x[i].complete = True
---
id: number of assets
generic object: ALAssetList
question: |
  How many assets do you have?
fields:
  - no label: x.target_number
    datatype: integer
---
id: info for each asset
generic object: ALAssetList
question: |
  About your ${ x[i].source } asset
fields:
  - Current market value: x[i].market_value
    datatype: currency
    required: False
  - Balance (for a financial account, may be identical to market value): x[i].balance
    datatype: currency
    required: False
  - How much does this asset earn you (in interest, dividends or other regular payments to you)?: x[i].value
    datatype: currency
    required: False
  - How often do you get money for this asset?: x[i].times_per_year
    input type: radio
    code: |
      times_per_year_list
    datatype: integer
    required: False
---
# UNIQUE FOR ALVehicle
---
generic object: ALVehicle
code: |
  # .source is automatically 'vehicle'
  x.market_value
  x.complete = True
---
comment: |
  Notes:

  A Vehicle is a child class of Asset, and so it has attributes like value
  (representing income earned), times_per_year, balance, and market_value, but
  for most vehicle owners only the `balance` and `market_value` attributes from
  ALAsset will be meaningful.
id: one vehicle info
generic object: ALVehicle
question: |
  Tell us about your vehicle
fields:
  - Year: x.year
    input type: combobox
    code: |
      recent_years()
  - Make: x.make
    help: For example, Ford, Honda
  - Model: x.model
    help: For example, Fusion, Civic
  - Market value: x.market_value
    datatype: currency
  - Loan balance: x.balance
    datatype: currency
    required: False
  - Income earned: x.value
    datatype: currency
    required: False
  - How often is the income earned?: x.times_per_year
    datatype: integer
    code: times_per_year_list
  - Who owns this?: x.owner
---
# UNIQUE FOR ALVehicleList
---
# Has to have its own. Otherwise it's overridden by ALAssetList.
generic object: ALVehicleList
code: |
  # .source is automatically 'vehicle'
  x[i].market_value
  x[i].complete = True
---
id: how many vehicles
generic object: ALVehicleList
question: |
  How many vehicles do you have?
fields:
  - no label: x.target_number
    datatype: integer
---
id: vehicle in list info
generic object: ALVehicleList
question: |
  Tell us about your ${ ordinal( i ) } vehicle
subquestion: |
  % if len(x.complete_elements()) > 0:
  So far you have told us about:
  
  % for item in x.complete_elements():
  * ${ item.year_make_model() }
  % endfor
  % endif
  
fields:
  - Year: x[i].year
    input type: combobox
    code: |
      recent_years()
  - Make: x[i].make
    hint: e.g, Ford, Honda
  - Model: x[i].model
    hint: e.g., Fusion, Civic
  - Current value: x[i].value
    datatype: currency
  - Loan balance: x[i].balance
    datatype: currency
  - Who owns this?: x[i].owner
---
# UNIQUE FOR ALSimpleValue
---
comment: |
  Note: An ALSimpleValue doesn't require a transaction type in order to work.
id: simple value
generic object: ALSimpleValue
question: |
  Tell us about the value
subquestion: |
fields:
  - Value: x.value
    datatype: currency
  - Transaction type: x.transaction_type
    datatype: radio
    required: False
    choices:
      - Expense: expense
      - Income: income
---
# SHARED BY ALSimpleValueList
---
id: how many simple values
generic object: ALSimpleValueList
question: |
  How many values do you have in your ${ x.object_name() } ${ x.__class__.__name__ }?
fields:
  - no label: x.target_number
    datatype: integer
    default: 2
---
# UNIQUE TO ALSimpleValueList
---
generic object: ALSimpleValueList
code: |
  x[i].value
  x[i].complete = True
---
comment: |
  Note: An ALSimpleValue doesn't require a transaction type in order to work.
id: value list item value
generic object: ALSimpleValueList
question: |
  Tell us about the ${ ordinal(i) } value for your ${ x.object_name() } ${ x.__class__.__name__ }
subquestion: |
fields:
  - Source: x[i].source
  - Value: x[i].value
    datatype: currency
  - Transaction type: x[i].transaction_type
    datatype: radio
    required: False
    choices:
      - Expense: expense
      - Income: income
---
# TRANSLATIONS
---
variable name: job_items_names
data:
  full time: Full time wages
  part time: Part time wages
  tips: Tips
  insurance: Insurance
  federal_taxes: Federal taxes
  state_taxes: State taxes
  social_security: Social security
  medicare: Medicare
---